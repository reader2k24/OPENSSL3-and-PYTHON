# Руководство по шифрованию с использованием OpenSSL

Этот репозиторий содержит инструкции и программы для демонстрации шифрования AES с использованием библиотеки OpenSSL.

## Шифрование с помощью командной строки OpenSSL
Параметры шифрования:
- Шифр: AES-256
- Режим работы: CBC (надо бы выбрать GCM, но этот режим командной программой не поддерживается)
- Тип дополнения: стандартное дополнение блока
### Предварительные требования
- Установленный OpenSSL на вашей системе

### Шаги
1. Установите необходимые пакеты, в случае их отсутствия:
    ```bash
    sudo apt install openssl libssl3 libssl-dev libssl-doc
    ```
2. Сгенерируйте тестовый файл:
    ```bash
    seq 20000 > somefile.txt
    ```
3. Сгенерируйте 256-битный ключ шифрования:
    ```bash
    openssl rand -hex 32
    ```
4. Сгенерируйте 128-битный вектор инициализации (IV):
    ```bash
    openssl rand -hex 16
    ```
5. Зашифруйте файл с использованием AES-256 в режиме CBC:
    ```bash
    openssl enc -aes-256-cbc -K <ключ-256bit> -iv <ключ-128bit> -e -in somefile.txt -out somefile.txt.encrypted
    ```

### Проверка
1. Проверьте, создан ли зашифрованный файл:
    ```bash
    ls -o somefile.txt*
    ```
    Обратите внимание, что зашифрованный файл на 11 байт длиннее (3904 вместо 3893 байт) и что число 3904 кратно 16. Лишние       11 байт – результат дополнения до 16-байтового блока.

2. Расшифруйте файл:
    ```bash
    openssl enc -aes-256-cbc -K <ключ-256bit> -iv <ключ-128bit> -d -in somefile.txt.encrypted -out somefile.txt.decrypted
    ```
3. Проверьте, совпадает ли расшифрованный файл с исходным:
    ```bash
    cksum somefile.txt*
    ```

## Шифрование с помощью пользовательской программы
### Программа encrypt
Программа `encrypt` шифрует файл с использованием AES-256 в режиме GCM. Она принимает три аргумента:
1. Имя входного файла
2. Имя выходного файла
3. Ключ шифрования в шестнадцатеричном формате

### Предварительные требования
- установленный пакет `cryptography`

### Инструкция по установки `cryptography` в виртуальном окружении
1. Создайте виртуальное окружение:
    ```bash
    python -m venv myenv
    ```
2. Активируйте виртуальное окружение:
    ```bash
    source myenv/bin/activate
    ```
3. Установите библиотеку `cryptography`:
    ```bash
    pip install cryptography
    ```

### Шаги
1. Удалите ранее созданные файлы:
    ```bash
    rm somefile.txt.*
    ```
2. Сгенерируйте тестовый файл:
    ```bash
    seq 20000 > somefile.txt
    ```
3. Зашифруйте файл с помощью программы `encrypt`:
    ```bash
    python3 encrypt somefile.txt somefile.txt.encrypted <ключ-256bit>
    ```

### Проверка
1. Проверьте размеры и контрольные суммы файлов:
    ```bash
    cksum somefile.txt*
    ```

## Расшифровка с помощью пользовательской программы
### Программа decrypt
Программа `decrypt` расшифровывает файл, зашифрованный программой `encrypt`. Она также принимает три аргумента:
1. Имя входного файла
2. Имя выходного файла
3. Ключ шифрования в шестнадцатеричном формате

### Шаги
1. Расшифруйте файл с помощью программы `decrypt`:
    ```bash
    python3 decrypt somefile.txt.encrypted somefile.txt.decrypted <ключ-256bit>
    ```

### Проверка
1. Проверьте размеры и контрольные суммы файлов:
    ```bash
    cksum somefile.txt*
    ```

## Заключение
Этот репозиторий демонстрирует шифрование и расшифровку AES с использованием как командной строки OpenSSL, так и пользовательских программ. Предоставленные инструкции и программы обеспечивают безопасное шифрование и расшифровку файлов с использованием шифрования AES-256 в различных режимах.
